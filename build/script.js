import{listCategory,allCategory,listCityDelivery,selectPayment}from"./product.js";const navLinks=document.querySelectorAll(".nav-link"),colCenter=document.querySelector(".colCenter"),colRight=document.querySelector(".colRight"),buttonOrders=document.querySelector(".buttonOrders");buttonOrders.addEventListener("click",displayOrders);const orders={};function shortProduct(e){const t=document.createElement("div");t.classList.add("border"),t.setAttribute("data-imgsrc",e.img),t.setAttribute("data-name",e.name),t.setAttribute("data-description",e.description),t.setAttribute("data-price",e.price),colCenter.appendChild(t);const n=document.createElement("div");n.classList.add("wrap"),t.appendChild(n);const a=document.createElement("div");a.classList.add("product-wrap"),n.appendChild(a);const l=document.createElement("a");l.href=e.img;const o=document.createElement("img");o.src=e.img,l.appendChild(o),a.appendChild(l);const c=document.createElement("div");c.classList.add("product-info"),t.appendChild(c);const r=document.createElement("h3");r.classList.add("product-title"),r.innerText=e.name,c.appendChild(r);const d=document.createElement("div");d.classList.add("price"),c.appendChild(d),d.innerHTML=`Ціна: ${e.price} &#8372;`}function addBorderClickListeners(){document.querySelectorAll(".border").forEach((e=>{e.addEventListener("click",(()=>{colRight.style.display="block";detailedProduct(e.getAttribute("data-imgsrc"),e.getAttribute("data-name"),e.getAttribute("data-description"),e.getAttribute("data-price"))}))}))}function detailedProduct(e,t,n,a){colRight.innerText="";const l=document.createElement("div");l.classList.add("productContent"),colRight.appendChild(l);const o=document.createElement("div");o.classList.add("imgGallery"),l.appendChild(o);const c=document.createElement("img");o.appendChild(c),c.src=e,localStorage.setItem("imgSrc",e);const r=document.createElement("div");r.classList.add("productInfo"),l.appendChild(r);const d=document.createElement("div");d.classList.add("nameProduct"),d.innerText=t,r.appendChild(d),localStorage.setItem("nameProduct",t);const i=document.createElement("div");i.classList.add("descriptionProduct"),i.innerText=n,r.appendChild(i);const s=document.createElement("div");s.classList.add("product-price"),r.appendChild(s),s.innerHTML=`Ціна: ${a} &#8372;`,localStorage.setItem("priceProduct",a);const u=document.createElement("button");u.classList.add("buy-button"),u.type="button",u.innerText="Купити",r.appendChild(u),u.addEventListener("click",(()=>{createFormBuy(),colRight.style.display="none"})),colRight.appendChild(l),addBorderClickListeners()}function createFormBuy(){const e=document.createElement("div");e.classList.add("backgroundModal"),colCenter.appendChild(e);const t=document.createElement("div");t.classList.add("modal"),colCenter.appendChild(t);const n=document.createElement("div");n.classList.add("modalDiv"),n.innerText="Для оформлення замовлення, заповніть наступні поля:",t.appendChild(n);const a=document.createElement("label");a.innerText="* Введіть ПІБ: ",t.appendChild(a);const l=document.createElement("input");l.classList.add("inputFio"),l.type="text",l.placeholder="Прізвище, ім’я, по батькові",l.minLength="4",l.maxLength="50",null!==localStorage.getItem("fio")&&(l.value=localStorage.getItem("fio")),a.appendChild(l);const o=document.createElement("label");o.innerText="* Введіть телефон: ",t.appendChild(o);const c=document.createElement("input");c.classList.add("inputTelephone"),c.type="tel",c.minLength="10",c.maxLength="18",c.placeholder="Введіть телефон",null!==localStorage.getItem("tel")&&(c.value=localStorage.getItem("tel")),o.appendChild(c);const r=document.createElement("label");r.innerText="* Виберіть місто: ";const d=document.createElement("select");d.classList.add("selectCityId"),listCityDelivery.forEach((e=>{const t=document.createElement("option");t.innerText=e,t.value=e,d.appendChild(t)})),null!==localStorage.getItem("city")&&(d.value=localStorage.getItem("city")),r.appendChild(d),t.appendChild(r);const i=document.createElement("label");i.innerText="* Склад Нової пошти для надсилання: ",t.appendChild(i);const s=document.createElement("input");s.classList.add("inputSklad"),s.type="number",s.placeholder="Введіть номер складу",s.min=1,null!==localStorage.getItem("sklad")&&(s.value=localStorage.getItem("sklad")),i.appendChild(s);const u=document.createElement("label");u.innerText="Виберіть спосіб оплати: ";const m=document.createElement("select");m.classList.add("selectOplata"),selectPayment.forEach((e=>{const t=document.createElement("option");t.innerText=e,t.value=e,m.appendChild(t)})),null!==localStorage.getItem("oplata")&&(m.value=localStorage.getItem("oplata")),u.appendChild(m),t.appendChild(u);const p=document.createElement("label");p.innerText="Змініть кількість, якщо треба: ",t.appendChild(p);const g=document.createElement("input");g.classList.add("inputQuantity"),g.type="number",g.placeholder="1",g.value=1,g.min=1,g.step=1,null!==localStorage.getItem("quantity")&&(g.value=localStorage.getItem("quantity")),p.appendChild(g);const h=document.createElement("label");h.innerText="Коментар до замовлення: ",t.appendChild(h);const v=document.createElement("input");v.classList.add("inputComent"),v.type="text",v.placeholder="Ваш коментар...",v.minLength="4",v.maxLength="50",null!==localStorage.getItem("comment")&&(v.value=localStorage.getItem("comment")),h.appendChild(v);const C=document.createElement("button");C.classList.add("buttonListBuy"),C.type="button",C.innerText="Замовити",C.addEventListener("click",orderButtonClick),t.appendChild(C)}function orderButtonClick(){const e=document.querySelector(".modal");e.addEventListener("input",(function(e){}));const t=document.querySelector(".inputFio");localStorage.setItem("fio",t.value.trim());const n=document.querySelector(".inputTelephone");localStorage.setItem("tel",n.value.trim());const a=document.querySelector(".selectCityId");localStorage.setItem("city",a.value);const l=document.querySelector(".inputSklad");localStorage.setItem("sklad",l.value);const o=document.querySelector(".selectOplata");localStorage.setItem("oplata",o.value);const c=document.querySelector(".inputQuantity");localStorage.setItem("quantity",c.value);const r=document.querySelector(".inputComent");if(localStorage.setItem("comment",r.value),""!==t.value){if(t.value.length<t.minLength)return alert("Поле ПІБ має бути більшої довжини"),void(t.value="");if(!/^[A-Za-zа-яА-ЯёЁіІїЇєЄ\s']+$/.test(t.value))return alert("Поле ПІБ може містити тільки літери та пробіли."),void(t.value="");if(""!==n.value){if(/^[\d\s-()+]+$/.test(n.value))return n.value.length<n.minLength?(alert("Номер телефону має замало цифр."),void(n.value="")):void(""!=a.value?""!==l.value?(e.remove(),payList()):alert("Введіть номер склада, для доставки"):alert("Виберіть місто з випадаючого списку"));alert("Неправильний формат телефону.")}else alert("Введіть телефон.")}else alert("Введіть ПІБ.")}function payList(){const e=localStorage.getItem("fio"),t=localStorage.getItem("tel"),n=localStorage.getItem("city"),a=localStorage.getItem("sklad"),l=localStorage.getItem("nameProduct"),o=localStorage.getItem("imgSrc"),c=localStorage.getItem("quantity"),r=localStorage.getItem("oplata"),d=localStorage.getItem("priceProduct"),i=document.createElement("div");i.classList.add("payListContent"),colCenter.appendChild(i);const s=document.createElement("div");s.classList.add("payListTitle"),s.innerHTML=`Ви замовили: <h2>${l}</h2><br>\n<div><img src="${o}"></div><br>\n<div>Вартість: ${c}шт. * ${d} &#8372;  =  <b>${c*d}</b>&#8372;</div>`,i.appendChild(s);const u=document.createElement("p");u.innerHTML=`Покупець: <b>${e}</b><br>Телефон: <b>${t}</b><br>Місто: <b>${n}</b><br>Склад №: <b>${a}</b><br>Оплата: <b>${r}</b>`,i.appendChild(u);const m=document.createElement("button");m.classList.add("buttonListBuy"),m.innerText="Закрити",i.appendChild(m),m.addEventListener("click",(function(){i.remove();document.querySelector(".backgroundModal").remove(),localStorage.removeItem("oplata"),localStorage.removeItem("quantity"),localStorage.removeItem("comment");const e=JSON.parse(localStorage.getItem("Orders"));e&&Object.assign(orders,e);const t=new function(e,t,n,a,l){this.buyerProductName=e,this.buyerImgProduct=t,this.productQuantity=n,this.productOplata=a,this.priceProduct=l}(l,o,c,r,d);t.orderDate=(new Date).toLocaleString(),function(e){let t=JSON.parse(localStorage.getItem("Orders"))||{};const n=function(e){return Object.keys(e).length+1}(t);t[n]=e,localStorage.setItem("Orders",JSON.stringify(t))}(t)}))}function displayOrders(){colCenter.innerHTML="",navLinks.forEach((e=>{e.classList.remove("active")})),buttonOrders.classList.add("active");const e=JSON.parse(localStorage.getItem("Orders"));if(!e){const e=document.createElement("p");return e.innerText="Замовлень немає.",void colCenter.appendChild(e)}const t=Object.keys(e);if(0===t.length){const e=document.createElement("p");return e.innerText="Замовлень немає.",void colCenter.appendChild(e)}for(const n of t){const t=e[n],a=document.createElement("div");a.classList.add("orderDiv"),a.innerHTML=`\n      <h3>Замовлення №${n}</h3>\n      <h4>${t.buyerProductName}</h4>\n      <img src="${t.buyerImgProduct}">\n      <p>Кількість: ${t.productQuantity}</p>\n      <p>Загальна ціна: ${t.priceProduct*t.productQuantity} &#8372;</p>\n      <p>Оплата: ${t.productOplata}</p>\n      <p>Дата та час замовлення: ${t.orderDate}</p>\n      <button class="delete-button" data-order-number="${n}">Видалити</button>\n    `,colCenter.appendChild(a);a.querySelector(".delete-button").addEventListener("click",(e=>{const t=e.target.getAttribute("data-order-number"),n=JSON.parse(localStorage.getItem("Orders"));delete n[t],localStorage.setItem("Orders",JSON.stringify(n)),displayOrders()}))}}navLinks.forEach(((e,t)=>{e.textContent=listCategory[t],allCategory[t].forEach((e=>{shortProduct(e)})),e.addEventListener("click",(n=>{for(n.preventDefault(),buttonOrders.classList.remove("active"),navLinks.forEach((e=>{e.classList.remove("active")})),e.classList.add("active");colCenter.firstChild;)colCenter.removeChild(colCenter.firstChild);allCategory[t].forEach((e=>{shortProduct(e)})),addBorderClickListeners()}))})),addBorderClickListeners();